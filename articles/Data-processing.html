<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data-processing • gnomeR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data-processing">
<meta property="og:description" content="gnomeR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gnomeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/API-tutorial.html">API-tutorial</a>
    </li>
    <li>
      <a href="../articles/Analizing-genomic-data.html">Analizing genomic data</a>
    </li>
    <li>
      <a href="../articles/Data-processing.html">Data-processing</a>
    </li>
    <li>
      <a href="../articles/Visualizations.html">Visualizations</a>
    </li>
    <li>
      <a href="../articles/gnomeR-vignette.html">gnomeR for IMPACT data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AxelitoMartin/gnomeR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Data-processing_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data-processing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AxelitoMartin/gnomeR/blob/master/vignettes/Data-processing.Rmd"><code>vignettes/Data-processing.Rmd</code></a></small>
      <div class="hidden name"><code>Data-processing.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AxelitoMartin/gnomeR">gnomeR</a></span><span class="op">)</span></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The main purpose of <code>gnomeR</code> is to streamline the processing of genomic files provided by CbioPortal. If you wish to learn how to use the integrated API please read the <code>API-tutorial</code> article first. The core function of the processing of these files is performed by the <code><a href="../reference/binmat.html">binmat()</a></code> function. It takes the following arguments:</p>
<ul>
<li>patients: A character vector that let’s the user specify the patients to be used to create the matrix. Default is NULL, in which case all samples found in the provided genetic files will be used.</li>
<li>maf: A MAF file.</li>
<li>mut.type: The mutation type to be used. Options are “SOMATIC”, “GERMLINE” or “ALL”. Note “ALL” will keep all mutations regardless of status (not recommended). Default is SOMATIC.</li>
<li>SNP.only Boolean to rather the genetics events to be kept only to be SNPs (insertions and deletions will be removed). Default is FALSE.</li>
<li>include.silent: Boolean to keep or remove all silent mutations. TRUE keeps, FALSE removes. Default is FALSE.</li>
<li>fusion: An optional MAF file for fusions. If inputed the outcome will be added to the matrix with columns ending in “.fus”. Default is NULL. Note if fusions are found in the MAF file in the previous input then these will be added automatically.</li>
<li>cna: An optional CNA files. If inputed the outcome will be added to the matrix with columns ending in “.cna”, .del" and “.amp” (depending on subsequent arguments).</li>
<li>cna.binary: A boolean argument specifying if the cna events should be enforced as binary. In which case separate columns for amplifications and deletions will be created. Default is FALSE in which case columns ending in “.cna” will be added to the output.</li>
<li>cna.relax: If cna.binary is TRUE, cna data only enables to count both gains and shallow deletions as amplifications and deletions respectively.</li>
<li>spe.plat: boolean specifying if specific IMPACT platforms should be considered. When TRUE NAs will fill the cells for genes of patients that were not sequenced on that plaform. Default is TRUE.</li>
<li>set.plat character argument specifying which IMPACT platform the data should be reduced to if spe.plat is set to TRUE. Options are “341” and “410”. Default is NULL.</li>
<li>rm.empty: boolean specifying if columns with no events founds should be removed. Default is TRUE.</li>
<li>pathway boolean specifying if pathway annotation should be applied. If TRUE, the function will return a supplementary binary dataframe with columns being each pathway and each row being a sample. Default is FALSE.</li>
<li>col.names character vector of the necessary columns to be used. By default: col.names = c(Tumor_Sample_Barcode = NULL, Hugo_Symbol = NULL, Variant_Classification = NULL, Mutation_Status = NULL, Variant_Type = NULL)</li>
<li>oncokb boolean specfiying if maf file should be oncokb annotated. Variants found to be ‘Oncogenic’ and ‘Likely Oncogenic’ will be kept. Default is FALSE.</li>
</ul>
<p>This function returns a matrix containing all the genetic information with rows as samples and columns as features. A warning will be thrown if some samples were found to have no mutations in the MAF file.</p>
<p>In the follwing sections we will present examples to process each of the datatypes in cbioportal.</p>
</div>
<div id="processing-genetic-data" class="section level1">
<h1 class="hasAnchor">
<a href="#processing-genetic-data" class="anchor"></a>Processing genetic data</h1>
<div id="mutations" class="section level2">
<h2 class="hasAnchor">
<a href="#mutations" class="anchor"></a>Mutations</h2>
<p>The most commmon type of genetic features used in genomic studies at MSKCC. The IMPACT sequencing panel consist of a curated list of genes that are known to have cancer related properties when altered. You can find a complete list of these genes and which platform they were added on in the <code>impact_genes</code> datafile. Note that the MAF files provided through the API embedded in this package and the one provided through raw download on the website are slightly different and we will thus present examples using both these datasets.</p>
<div id="processing-raw-mutation-data" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-raw-mutation-data" class="anchor"></a>Processing raw mutation data</h3>
<p>We included in <code>gnomeR</code> an example of raw downloaded MAF file directly from the website in the <code>mut</code> dataset. We show here an example selecting a random subset of 100 samples in the <code>mut</code> dataset:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">mut</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3,179 x 45</span>
<span class="co">#&gt;    Hugo_Symbol Entrez_Gene_Id Center NCBI_Build Chromosome Start_Position</span>
<span class="co">#&gt;    &lt;fct&gt;       &lt;lgl&gt;          &lt;lgl&gt;  &lt;fct&gt;      &lt;fct&gt;               &lt;int&gt;</span>
<span class="co">#&gt;  1 TP53        NA             NA     GRCh37     17                7577539</span>
<span class="co">#&gt;  2 EZH2        NA             NA     GRCh37     7               148523605</span>
<span class="co">#&gt;  3 MDM2        NA             NA     GRCh37     12               69222656</span>
<span class="co">#&gt;  4 IGF1R       NA             NA     GRCh37     15               99486153</span>
<span class="co">#&gt;  5 KEAP1       NA             NA     GRCh37     19               10602303</span>
<span class="co">#&gt;  6 KDM5C       NA             NA     GRCh37     X                53223386</span>
<span class="co">#&gt;  7 KRAS        NA             NA     GRCh37     12               25398284</span>
<span class="co">#&gt;  8 TERT        NA             NA     GRCh37     5                 1295228</span>
<span class="co">#&gt;  9 MAP2K1      NA             NA     GRCh37     15               66729153</span>
<span class="co">#&gt; 10 NCOR1       NA             NA     GRCh37     17               16046949</span>
<span class="co">#&gt; # … with 3,169 more rows, and 39 more variables: End_Position &lt;int&gt;,</span>
<span class="co">#&gt; #   Strand &lt;fct&gt;, Consequence &lt;fct&gt;, Variant_Classification &lt;fct&gt;,</span>
<span class="co">#&gt; #   Variant_Type &lt;fct&gt;, Reference_Allele &lt;fct&gt;, Tumor_Seq_Allele1 &lt;fct&gt;,</span>
<span class="co">#&gt; #   Tumor_Seq_Allele2 &lt;fct&gt;, dbSNP_RS &lt;lgl&gt;, dbSNP_Val_Status &lt;lgl&gt;,</span>
<span class="co">#&gt; #   Tumor_Sample_Barcode &lt;fct&gt;, Matched_Norm_Sample_Barcode &lt;lgl&gt;,</span>
<span class="co">#&gt; #   Match_Norm_Seq_Allele1 &lt;lgl&gt;, Match_Norm_Seq_Allele2 &lt;lgl&gt;,</span>
<span class="co">#&gt; #   Tumor_Validation_Allele1 &lt;lgl&gt;, Tumor_Validation_Allele2 &lt;lgl&gt;,</span>
<span class="co">#&gt; #   Match_Norm_Validation_Allele1 &lt;lgl&gt;, Match_Norm_Validation_Allele2 &lt;lgl&gt;,</span>
<span class="co">#&gt; #   Verification_Status &lt;lgl&gt;, Validation_Status &lt;lgl&gt;, Mutation_Status &lt;chr&gt;,</span>
<span class="co">#&gt; #   Sequencing_Phase &lt;lgl&gt;, Sequence_Source &lt;lgl&gt;, Validation_Method &lt;lgl&gt;,</span>
<span class="co">#&gt; #   Score &lt;lgl&gt;, BAM_File &lt;lgl&gt;, Sequencer &lt;lgl&gt;, t_ref_count &lt;int&gt;,</span>
<span class="co">#&gt; #   t_alt_count &lt;int&gt;, n_ref_count &lt;lgl&gt;, n_alt_count &lt;lgl&gt;, HGVSc &lt;fct&gt;,</span>
<span class="co">#&gt; #   HGVSp &lt;fct&gt;, HGVSp_Short &lt;fct&gt;, Transcript_ID &lt;fct&gt;, RefSeq &lt;fct&gt;,</span>
<span class="co">#&gt; #   Protein_position &lt;int&gt;, Codons &lt;fct&gt;, Hotspot &lt;int&gt;</span>
<span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mut</span><span class="op">$</span><span class="va">Tumor_Sample_Barcode</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mut</span><span class="op">$</span><span class="va">Tumor_Sample_Barcode</span><span class="op">)</span><span class="op">)</span>, <span class="fl">100</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>patients <span class="op">=</span> <span class="va">samples</span> ,maf <span class="op">=</span> <span class="va">mut</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">FLT4</th>
<th align="right">KRAS</th>
<th align="right">TP53</th>
<th align="right">NF1</th>
<th align="right">ARID1A</th>
<th align="right">CARD11</th>
<th align="right">ARID5B</th>
<th align="right">BCOR</th>
<th align="right">MLL2</th>
<th align="right">SMAD3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P-0010604-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002651-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0000270-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002915-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0011099-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0000080-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0001741-T01-IM3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0003964-T01-IM3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0003842-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002597-T02-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Note that by default in the situation above the outputted dataframe is a binary matrix made from all types of mutations and adjusting the features for the platform they were added on. Thus all samples that were sequenced on the original platform have NA’s in the cells of for features that were added on subsequent platforms. In the case where the user plans on using methods that do not accept missing values, the <code>spe.plat</code> argument can be changed to FALSE to replace all the NA’s mentioned above to 0. We show below such an example, we moreover make this example including only SNPs (including silent mutations):</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>patients <span class="op">=</span> <span class="va">samples</span> ,maf <span class="op">=</span> <span class="va">mut</span>, SNP.only <span class="op">=</span> <span class="cn">TRUE</span>, include.silent <span class="op">=</span> <span class="cn">TRUE</span>, spe.plat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">FLT4</th>
<th align="right">KRAS</th>
<th align="right">TP53</th>
<th align="right">NF1</th>
<th align="right">ARID1A</th>
<th align="right">CARD11</th>
<th align="right">ARID5B</th>
<th align="right">MLL2</th>
<th align="right">SMAD3</th>
<th align="right">CIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P-0010604-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002651-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0000270-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002915-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0011099-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0000080-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0001741-T01-IM3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0003964-T01-IM3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0003842-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002597-T02-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="processing-mutation-data-from-the-api" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-mutation-data-from-the-api" class="anchor"></a>Processing mutation data from the API</h3>
<p>In this section we show the same examples as above but using the data downloaded through the API:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># samples.tcga &lt;- tcga_samples$patient_id[1:50]</span>
<span class="co"># dat &lt;- get_genetics(sample_ids = samples.tcga, database = 'tcga', fusions = FALSE, cna = FALSE)</span>
<span class="co"># df &lt;- binmat(maf = dat$mut)</span></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co"># kable(df[1:10, 1:10])</span></pre></div>
<p>Similarly,</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># df &lt;- binmat(maf = dat$mut, SNP.only = TRUE, include.silent = TRUE, spe.plat = FALSE)</span>
<span class="co"># kable(df[1:10, 1:10])</span></pre></div>
</div>
</div>
<div id="fusions" class="section level2">
<h2 class="hasAnchor">
<a href="#fusions" class="anchor"></a>Fusions</h2>
<p>Fusions are a particular genetic event where two genes merge to create a fusion gene which is a hybrid gene formed from the two previously independent genes. It can occur as a result of translocation, interstitial deletion, or chromosomal inversion. In IMPACT datasets these can be found either in their own file or aggregated in the MAF file for mutations. In general the file containing the fusions will be very similar to a MAF file, explaining why they may be found together. We show here how to process these alterations in both cases listed above. Note that fusions are particularly rare events and thus the resulting data is very sparse.</p>
<div id="processing-raw-fusion-data" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-raw-fusion-data" class="anchor"></a>Processing raw fusion data</h3>
<p>We included in <code>gnomeR</code> an example of raw downloaded MAF file directly from the website in the <code>fusion</code> dataset. We show here an example selecting the same random subset of 100 samples as in the previous section:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">fusion</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 127 x 10</span>
<span class="co">#&gt;    Hugo_Symbol Entrez_Gene_Id Center Tumor_Sample_Ba… Fusion DNA_support</span>
<span class="co">#&gt;    &lt;fct&gt;                &lt;int&gt; &lt;fct&gt;  &lt;fct&gt;            &lt;fct&gt;  &lt;fct&gt;      </span>
<span class="co">#&gt;  1 PAX8                    NA MSKCC… P-0010011-T01-I… PAX8-… yes        </span>
<span class="co">#&gt;  2 TFE3                    NA MSKCC… P-0010977-T01-I… ASPSC… yes        </span>
<span class="co">#&gt;  3 ASPSCR1                 NA MSKCC… P-0010977-T01-I… ASPSC… yes        </span>
<span class="co">#&gt;  4 BRAF                    NA MSKCC… P-0010398-T01-I… OSBPL… yes        </span>
<span class="co">#&gt;  5 OSBPL9                  NA MSKCC… P-0010398-T01-I… OSBPL… yes        </span>
<span class="co">#&gt;  6 ALK                     NA MSKCC… P-0010177-T01-I… EML4-… yes        </span>
<span class="co">#&gt;  7 EML4                    NA MSKCC… P-0010177-T01-I… EML4-… yes        </span>
<span class="co">#&gt;  8 MLL3                    NA MSKCC… P-0010604-T01-I… MLL3-… yes        </span>
<span class="co">#&gt;  9 ERG                     NA MSKCC… P-0010794-T01-I… TMPRS… yes        </span>
<span class="co">#&gt; 10 TMPRSS2                 NA MSKCC… P-0010794-T01-I… TMPRS… yes        </span>
<span class="co">#&gt; # … with 117 more rows, and 4 more variables: RNA_support &lt;fct&gt;, Method &lt;lgl&gt;,</span>
<span class="co">#&gt; #   Frame &lt;fct&gt;, Comments &lt;fct&gt;</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>patients <span class="op">=</span> <span class="va">samples</span> ,fusion <span class="op">=</span> <span class="va">fusion</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<colgroup>
<col width="15%">
<col width="7%">
<col width="9%">
<col width="7%">
<col width="7%">
<col width="7%">
<col width="8%">
<col width="7%">
<col width="10%">
<col width="7%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">BRAF.fus</th>
<th align="right">OSBPL9.fus</th>
<th align="right">ALK.fus</th>
<th align="right">EML4.fus</th>
<th align="right">MLL3.fus</th>
<th align="right">BRCA2.fus</th>
<th align="right">ERG.fus</th>
<th align="right">TMPRSS2.fus</th>
<th align="right">ATM.fus</th>
<th align="right">ELOVL4.fus</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P-0010604-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002651-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0000270-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002915-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0011099-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0000080-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0001741-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0003964-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0003842-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002597-T02-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="processing-fusions-from-the-api" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-fusions-from-the-api" class="anchor"></a>Processing fusions from the API</h3>
<p>In the API provided in <code>gnomeR</code> the fusion data comes merged with the mutation data. Note that we included an option to automatically filter them out if the user wishes so.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="co"># dat &lt;- get_genetics(sample_ids = samples.tcga, database = 'tcga',mutations = FALSE, fusions = TRUE, cna = FALSE)</span>
<span class="co"># df &lt;- binmat(maf = dat$mut)</span></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="co"># kable(df[1:10, 1:10])</span></pre></div>
<p>Similarly to the mutation data the fusions are affected by the <code>spe.plat</code> and <code>set.plat</code> arguments as well.</p>
</div>
</div>
<div id="copy-number-alterations-cna" class="section level2">
<h2 class="hasAnchor">
<a href="#copy-number-alterations-cna" class="anchor"></a>Copy-number alterations (CNA)</h2>
<p>The final type of data we have left to cover are CNAs. This a phenomenon in which sections of the genome are repeated and the number of repeats in the genome varies between individuals. Copy number variation is a type of structural variation: specifically, it is a type of duplication or deletion event that affects a considerable number of base pairs. We will show in this section how to process CNA from IMPACT data. Once again we include an example dataset, <code>cna</code> in <code>gnomeR</code>. We will show in this section how to process raw CNA data and CNA data from the API.</p>
<p>The processing function for CNA is affected by two additional arguments:</p>
<ul>
<li>
<code>cna.binary</code>: boolean declaring if the CNA data should be segregated between amplification and deletions or kept as factor variable with its original levels</li>
<li>
<code>cna.relax</code>: a boolean declaring if only deep deletions and full amplifications should be annotated in the case where <code>cna.binary</code> is set to FALSE.</li>
</ul>
<p>Note that the <code>spe.plat</code> and <code>set.plat</code> also affect CNA.</p>
<div id="processing-raw-cna-data" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-raw-cna-data" class="anchor"></a>Processing raw CNA data</h3>
<p>By default amplifications and deletions will be separated and only deep deletions/full amplifications will accounted as shown below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>patients <span class="op">=</span> <span class="va">samples</span>, cna <span class="op">=</span> <span class="va">cna</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<colgroup>
<col width="15%">
<col width="7%">
<col width="6%">
<col width="9%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">AKT2.Amp</th>
<th align="right">AR.Amp</th>
<th align="right">ARID5B.Del</th>
<th align="right">AURKA.Amp</th>
<th align="right">AXIN1.Amp</th>
<th align="right">AXIN2.Amp</th>
<th align="right">BRIP1.Amp</th>
<th align="right">CCND1.Amp</th>
<th align="right">CCND3.Amp</th>
<th align="right">CCNE1.Amp</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P-0001890-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0000569-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0002651-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0001388-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0002374-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002463-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0000407-T01-IM3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">P-0001724-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0001239-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0001296-T01-IM3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Setting <code>cna.binary</code> argument to FALSE yields the following events coded in a single column with their original levels:</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>patients <span class="op">=</span> <span class="va">samples</span>, cna <span class="op">=</span> <span class="va">cna</span>, cna.binary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="9%">
<col width="7%">
<col width="11%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">AKT2.cna</th>
<th align="left">AKT3.cna</th>
<th align="left">AR.cna</th>
<th align="left">ARID5B.cna</th>
<th align="left">AURKA.cna</th>
<th align="left">AXIN1.cna</th>
<th align="left">AXIN2.cna</th>
<th align="left">BRCA2.cna</th>
<th align="left">BRIP1.cna</th>
<th align="left">CCND1.cna</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
</div>
<div id="processing-cna-data-from-the-api" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-cna-data-from-the-api" class="anchor"></a>Processing CNA data from the API</h3>
<p>Setting the <code>cna</code> argument to TRUE in the <code>get_genetics()</code> function will retrieve the CNA data for the specified samples that can then further be processed in a similar fashion to the above:</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="co"># dat &lt;- get_genetics(sample_ids = samples.tcga, database = 'tcga',mutations = FALSE, fusions = FALSE, cna = TRUE)</span>
<span class="co"># df &lt;- binmat(cna = dat$cna)</span></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co"># kable(df[1:10, 1:10])</span></pre></div>
<p>Setting <code>cna.binary</code> argument to FALSE yields the following events coded in a single column with their original levels:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="co"># df &lt;- binmat(patients = samples, cna = dat$cna,cna.binary = FALSE)</span>
<span class="co"># kable(df[1:10, 1:10])</span></pre></div>
</div>
</div>
<div id="processing-full-genetic-profiles-for-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#processing-full-genetic-profiles-for-samples" class="anchor"></a>Processing full genetic profiles for samples</h2>
<p>By combining all the types of data presented above, <code><a href="../reference/binmat.html">binmat()</a></code> will provide a complete genomic profile for the specified samples. This can be done with any combination of the arguments presented above.</p>
<div id="using-raw-data-files" class="section level3">
<h3 class="hasAnchor">
<a href="#using-raw-data-files" class="anchor"></a>Using raw data files</h3>
<p>Once again we show how to perform this using the files directly downloaded from cBioPortal, combining the example sets <code>mut</code>, <code>fusion</code> and <code>cna</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>patients <span class="op">=</span> <span class="va">samples</span>,maf <span class="op">=</span> <span class="va">mut</span>, fusion <span class="op">=</span> <span class="va">fusion</span>, cna <span class="op">=</span> <span class="va">cna</span>, cna.binary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">243</span>,<span class="fl">244</span>,<span class="fl">300</span><span class="op">:</span><span class="fl">305</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<colgroup>
<col width="16%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="8%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="8%">
<col width="8%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">FLT4</th>
<th align="right">KRAS</th>
<th align="right">TP53</th>
<th align="right">BRAF.fus</th>
<th align="right">OSBPL9.fus</th>
<th align="left">FANCA.cna</th>
<th align="left">FGF19.cna</th>
<th align="left">FGF3.cna</th>
<th align="left">FGF4.cna</th>
<th align="left">FGFR1.cna</th>
<th align="left">FGFR2.cna</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P-0010604-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">P-0002651-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">P-0000270-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">P-0002915-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">P-0011099-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">P-0000080-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">P-0001741-T01-IM3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">P-0003964-T01-IM3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">P-0003842-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">P-0002597-T02-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
</div>
<div id="from-the-api" class="section level3">
<h3 class="hasAnchor">
<a href="#from-the-api" class="anchor"></a>From the API</h3>
<p>Similarly we get retrieve all the genetic events at once through the <code>get_genetics()</code> function and proceed to process them.</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="co"># dat &lt;- get_genetics(sample_ids = samples.tcga, database = 'tcga',mutations = TRUE, fusions = TRUE, cna = TRUE)</span>
<span class="co"># df &lt;- binmat(maf = dat$mut, cna = dat$cna,cna.binary = FALSE)</span></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="co"># kable(df[1:10, c(1:3,243,244,300:305)])</span></pre></div>
<p>Note that here the fusions are embedded in the mutation file.</p>
</div>
</div>
</div>
<div id="pathway-level-alterations" class="section level1">
<h1 class="hasAnchor">
<a href="#pathway-level-alterations" class="anchor"></a>Pathway level alterations</h1>
<p>Pathway level alteration analysis is commonly encountered in genomic studies. We therefore implemented in <code><a href="../reference/binmat.html">binmat()</a></code> the <code>pathway</code> argument that enables the user to generate a second binary matrix with pathways as new features (columns) for each of the samples (rows). These pathways were created following Dr. Schultz’s group in their paper <a href="https://www.cell.com/cell/pdf/S0092-8674(18)30359-3.pdf">Oncogenic Signaling Pathways in The Cancer Genome Atlas</a>. It consist of 10 well defined pathways that have biological impacts in cancer patients. We show below an example of this matrix.</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>patients <span class="op">=</span> <span class="va">samples</span>,maf <span class="op">=</span> <span class="va">mut</span>, cna <span class="op">=</span> <span class="va">cna</span>,cna.binary <span class="op">=</span> <span class="cn">FALSE</span>,pathway <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">pathway_dat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">p53</th>
<th align="right">Wnt</th>
<th align="right">PI3K</th>
<th align="right">RTK_RAS</th>
<th align="right">TGF_beta</th>
<th align="right">Notch</th>
<th align="right">cell_cycle</th>
<th align="right">Hippo</th>
<th align="right">Myc</th>
<th align="right">Nrf2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P-0010604-T01-IM5</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002651-T01-IM3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0000270-T01-IM3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">P-0002915-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0011099-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Note that this is returned as an additional element of <code><a href="../reference/binmat.html">binmat()</a></code> and the original binary matrix for all genes is still returned.</p>
<div id="custom-pathways" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-pathways" class="anchor"></a>Custom pathways</h2>
<p>In particular problems it may be of interest of creating pathways customized to the study conducted. To enable the user to use these specfic pathways we created the <code><a href="../reference/custom_pathway.html">custom_pathway()</a></code> function, this function takes as argument a binary output from <code><a href="../reference/binmat.html">binmat()</a></code> with a dataframe containing the name of the genes and their corresponding pathways:</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="va">pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PIK3CA"</span>,<span class="st">"KRAS"</span>,<span class="st">"TERT"</span>,<span class="st">"TP53"</span><span class="op">)</span>,
                               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"path1"</span>,<span class="st">"path1"</span>,<span class="st">"path2"</span>,<span class="st">"path3"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">pathway_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/custom_pathway.html">custom_pathway</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">mut</span>, pathway <span class="op">=</span> <span class="va">pathway</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">pathway_dat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">path1</th>
<th align="right">path2</th>
<th align="right">path3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P-0010604-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">P-0002651-T01-IM3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">P-0000270-T01-IM3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">P-0002915-T01-IM3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">P-0011099-T01-IM5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="oncokb-annotation" class="section level1">
<h1 class="hasAnchor">
<a href="#oncokb-annotation" class="anchor"></a>OncoKB annotation</h1>
<p>OncoKB annotates the biological and oncogenic effect and the prognostic and predictive significance of somatic molecular alterations. Potential treatment implications are stratified by the level of evidence that a specific molecular alteration is predictive of drug response based on US Food and Drug Administration (FDA) labeling, National Comprehensive Cancer Network (NCCN) guidelines, disease-focused expert group recommendations and the scientific literature. For more information see the manuscript <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5586540/">OncoKB: A Precision Oncology Knowledge Base</a> or the <a href="https://www.oncokb.org/">oncoKB</a> website. In <code>gnomeR</code> we include a simple wrapper of the <code>[annotateMaf](https://github.com/taylor-lab/annotateMaf)</code> package’s functions to allow users to annotate their MAF files. If the <code>oncokb</code> argument is set to TRUE the MAF will be subsetted to oncogenic and likely oncogenic variants. Note this can be performed externally using the <code><a href="../reference/oncoKB_annotate.html">oncoKB_annotate()</a></code> function as shown below:</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="co"># maf &lt;- mut[1:10,]</span>
<span class="co"># onco_maf &lt;- oncoKB_annotate(maf)</span>
<span class="co"># onco_maf %&gt;% select(Hugo_Symbol, Chromosome, Variant_Classification, oncogenic, oncokb_level )</span></pre></div>
<p>Annotating MAF in <code><a href="../reference/binmat.html">binmat()</a></code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="co"># df &lt;- binmat(patients = samples[1:5] ,maf = mut, oncokb = TRUE)</span>
<span class="co"># kable(df[1:5, 1:10])</span></pre></div>
</div>
<div id="facets" class="section level1">
<h1 class="hasAnchor">
<a href="#facets" class="anchor"></a>FACETs</h1>
<p>The copy-number alterations data we have covered up to now is a discrete estimation of the alterations that occured. There however exist more nuanced and accurate data for copy-number alterations observed in a tumor. In <code>gnomeR</code> we include an example of segmentation file and relevant functions from the <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5027494/"><code>facets</code></a> package that provides an allele-specific copy number and clonal heterogeneity analysis tool for high-throughput DNA sequencing. We show below an example of a segmentation file included in <code>gnomeR</code> (<code>seg</code> dataset) and how to process it:</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="fu">kable</span><span class="op">(</span><span class="va">seg</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">ID</th>
<th align="left">chrom</th>
<th align="right">loc.start</th>
<th align="right">loc.end</th>
<th align="right">num.mark</th>
<th align="right">seg.mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">1</td>
<td align="right">2488138</td>
<td align="right">16265857</td>
<td align="right">110</td>
<td align="right">-0.0100</td>
</tr>
<tr class="even">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">1</td>
<td align="right">17345415</td>
<td align="right">22587878</td>
<td align="right">10</td>
<td align="right">-0.4776</td>
</tr>
<tr class="odd">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">1</td>
<td align="right">27023463</td>
<td align="right">120199189</td>
<td align="right">190</td>
<td align="right">0.0070</td>
</tr>
<tr class="even">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">1</td>
<td align="right">120458623</td>
<td align="right">120465330</td>
<td align="right">8</td>
<td align="right">2.3998</td>
</tr>
<tr class="odd">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">1</td>
<td align="right">120466434</td>
<td align="right">120539788</td>
<td align="right">23</td>
<td align="right">1.2126</td>
</tr>
<tr class="even">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">1</td>
<td align="right">120548082</td>
<td align="right">150552561</td>
<td align="right">9</td>
<td align="right">0.4508</td>
</tr>
<tr class="odd">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">1</td>
<td align="right">152330945</td>
<td align="right">190734051</td>
<td align="right">85</td>
<td align="right">-0.0338</td>
</tr>
<tr class="even">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">1</td>
<td align="right">193091396</td>
<td align="right">245977996</td>
<td align="right">113</td>
<td align="right">0.4273</td>
</tr>
<tr class="odd">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">2</td>
<td align="right">4717089</td>
<td align="right">242800953</td>
<td align="right">419</td>
<td align="right">-0.0127</td>
</tr>
<tr class="even">
<td align="left">P-0001669-T01-IM3</td>
<td align="left">3</td>
<td align="right">1449872</td>
<td align="right">194238390</td>
<td align="right">458</td>
<td align="right">0.0051</td>
</tr>
</tbody>
</table>
<p>We see that this files include segments of all chromosome for each patient with the number of marks and mean intensity in that segments. We can process this data into a format that can be used for visualization and analysis using the <code><a href="../reference/facets.dat.html">facets.dat()</a></code> function that takes the following arguments:</p>
<ul>
<li>
<code>seg</code>: a segmentation file</li>
<li>
<code>filenames</code>: the names of the segment files to be loaded and processed (Note must end in “.Rdata”).</li>
<li>
<code>path</code>: the relative path to the files folder from your current directory</li>
<li>
<code>patients</code>: the names of the patients of the respective filenames. Default is using all samples available.</li>
<li>
<code>min.purity</code>: the minimum purity of the sample required to be kept in the final dataset. Default is 0.3.</li>
<li>
<code>epsilon</code>: level of unions when aggregating segments between. Default is 0.005.</li>
<li>
<code>adaptive</code>: CNregions option to create adaptive segments. Default is FALSE.</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="va">facet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/facets.dat.html">facets.dat</a></span><span class="op">(</span>seg <span class="op">=</span> <span class="va">seg</span>, patients <span class="op">=</span> <span class="va">samples</span>, epsilon <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></pre></div>
<p>This function returns a dataframe that is ready for visualization and analysis with samples as rows and processed segments as columns:</p>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="fu">kable</span><span class="op">(</span><span class="va">facet</span><span class="op">$</span><span class="va">out.cn</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">chr1.2488138-11167550</th>
<th align="right">chr1.11167550-15296019</th>
<th align="right">chr1.15296019-17345415</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P-0000080-T01-IM3</td>
<td align="right">0.1680</td>
<td align="right">0.1680</td>
<td align="right">0.1680</td>
</tr>
<tr class="even">
<td align="left">P-0000140-T01-IM3</td>
<td align="right">-0.1550</td>
<td align="right">-0.1550</td>
<td align="right">0.0092</td>
</tr>
<tr class="odd">
<td align="left">P-0000185-T01-IM3</td>
<td align="right">0.1126</td>
<td align="right">0.1126</td>
<td align="right">0.1126</td>
</tr>
<tr class="even">
<td align="left">P-0000244-T01-IM3</td>
<td align="right">-0.3711</td>
<td align="right">-0.0041</td>
<td align="right">-0.0041</td>
</tr>
<tr class="odd">
<td align="left">P-0000270-T01-IM3</td>
<td align="right">-0.0857</td>
<td align="right">-0.0857</td>
<td align="right">-0.0857</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Axel Martin, Arshi Arora, Karissa Whiting, Margie Hannum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
